# Contents
- [Contents](#contents)
- [Introduction](#introduction)
- [Description](#description)
  - [Fully connected forward computation](#fully-connected-forward-computation)
  - [Activation functions](#activation-functions)
    - [ReLU (Rectified Linear unit)](#relu-rectified-linear-unit)
    - [Tanh](#tanh)
  - [Pooling operation](#pooling-operation)
    - [Max pooling](#max-pooling)
    - [Average pooling](#average-pooling)
  - [Probability operations](#probability-operations)
    - [Sigmoid](#sigmoid)
    - [Softmax](#softmax)
- [Folder structure](#folder-structure)

# Introduction
Welcome to **Audio Processing Library Version 1.2**. 

V1.2 supports the following functionalities:
- Fully connected forward computation
  - Simple matrix multiplication with O($n^3$) for loop based computations
  - Implementation using Intel MKL library
  - Implementation using OpenBLAS library 
  - Implementation using pthreads in C++ (multi-threading to reduce computational complexity)
- ReLU and Tanh activations
- Max pooling and average pooling operations
- Sigmoid and Softmax probabilities

What's new in V1.2?
The matrix multiplication operation in the Fully connected forward computation has been accelerated using the following 
- Implementations using Intel MKL library to speed up  

# Description
## Fully connected forward computation
- **Name of the function**: fullyconnected; declared in headerfiles/fc.h and defined in cppfiles/fc.cpp
- **Inputs**: path of file containing input matrix (AxB dimensions) with 32-bit floats, path of file containing weight matrix (BxC dimensions) with 32-bit floats, path of file containing bias matrix (AxC dimensions) with 32-bit floats, path of file to write output matrix (AxC dimensions) with 32-bit floats, all written in specified matrix format
- **Usage (Command line instruction)**: ./yourcode.out fullyconnected inputmatrix.txt weightmatrix.txt biasmatrix.txt outputmatrix.txt 
- **Functionality implemented**: output_matrix = input_matrix*weight_matrix + bias_matrix

## Activation functions
### ReLU (Rectified Linear unit)
- **Name of function**: relu; declared in headerfiles/activations.h and defined in cppfiles/activations.cpp
- **Inputs**: path of file containing input matrix (AxB dimensions) with 32-bit floats, path of file to write output matrix (AxB dimensions) with 32-bit floats, all written in specified matrix format
- **Usage  (Command line instruction)**: ./yourcode.out activation relu inputmatrix.txt outputmatrix.txt
- **Functionality implemented**: output_matrix = element_wise_max(0, input_matrix)

### Tanh 
- **Name of function**: tanh; declared in headerfiles/activations.h and defined in cppfiles/activations.cpp
- **Inputs**: path of file containing input matrix (AxB dimensions) with 32-bit floats, path of file to write output matrix (AxB dimensions) with 32-bit floats, all written in specified matrix format
- **Usage  (Command line instruction)**: ./yourcode.out activation tanh inputmatrix.txt outputmatrix.txt
- **Functionality implemented**: output_matrix = element_wise_tanh(input_matrix)

## Pooling operation
### Max pooling
- **Name of function**: maxp; declared in headerfiles/pooling.h and defined in cppfiles/pooling.cpp
- **Usage  (Command line instruction)**: ./yourcode.out pooling max inputmatrix.txt stride outputmatrix.txt
- **Inputs**: path of file containing input matrix (AxB dimensions) with 32-bit floats, integer value of stride in pooling, path of file to write output matrix ((A/stride)x(B/stride) dimensions) with 32-bit floats, all written in specified matrix format
- **Functionality implemented**: output_matrix = max-pooling(input_matrix), where max-pooling(.) is the commonly used downsampling function, using the maximum value in (stride, stride) contiguous sub-matrices

### Average pooling
- **Name of function**: average; declared in headerfiles/pooling.h and defined in cppfiles/pooling.cpp
- **Inputs**: path of file containing input matrix (AxB dimensions) with 32-bit floats, integer value of stride in pooling, path of file to write output matrix ((A/stride)x(B/stride) dimensions) with 32-bit floats, all written in specified matrix format
- **Usage  (Command line instruction)**: ./yourcode.out pooling average inputmatrix.txt stride outputmatrix.txt
- **Functionality implemented**: output_matrix = average-pooling(input_matrix), where average-pooling(.) is the commonly used downsampling function, using the average value in (stride, stride) contiguous sub-matrices

## Probability operations
### Sigmoid
- **Name of function**: sigmoid; declared in headerfiles/probability.h and defined in cppfiles/probability.cpp
- **Inputs**: path of file containing input vector (A elements) with 32-bit floats, path of file to write output vector (A elements) with 32-bit floats, all written in specified vector format
- **Usage  (Command line instruction)**: ./yourcode.out probability sigmoid inputvector.txt outputvector.txt
- **Functionality implemented**: output_vector = element_wise_sigmoid(input_vector), where sigmoid(x) = $\frac{1}{1+e^{-x}}$

### Softmax
- **Name of function**: softmax; declared in headerfiles/probability.h and defined in cppfiles/probability.cpp
- **Inputs**: path of file containing input vector (A elements) with 32-bit floats, path of file to write output vector (A elements) with 32-bit floats, all written in specified vector format
- **Usage  (Command line instruction)**: ./yourcode.out probability softmax inputvector.txt outputvector.txt
- **Functionality implemented**: output_vector = softmax(input_vector), where softmax(x) = $\left[\frac{e^{x_i}}{\sum_{j\in \{1,..,|x|\}} e^{x_j}}\right]$

# Folder structure
- bin: folder containing executables for cpp files in cppfiles folder
    - activations.o
    - fc.o
    - pooling.o
    - probability.o
- cppfiles: folder containing definitions of functions declared in headerfiles folder
    - activations.cpp
    - fc.cpp
    - pooling.cpp
    - probability.cpp
- headerfiles: folder containing the functions needed by yourcode.cpp file
    - activations.h
    - fc.h
    - pooling.h
    - probability.h
- Makefile: file to compile the project
- readme.md: this documentation
- yourcode.cpp: file containing the main function to provide the functionalities
- yourcode.o: object file for yourcode.cpp
- yourcode.out: final executable output file linking yourcode.o and all the object files in the bin folder